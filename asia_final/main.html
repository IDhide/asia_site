<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Асия — официальный сайт: треки, концерты, мерч</title>
    <meta name="description" content="Официальный сайт артистки Асия: новые треки, расписание концертов, мерч, контакты и ответы на вопросы." />
    <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
    <link rel="canonical" href="https://asia.example/" />
    <link rel="alternate" hreflang="ru-ru" href="https://asia.example/" />
    <link rel="icon" type="image/png" href="src/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="src/favicon/favicon.svg" />
    <link rel="shortcut icon" href="src/favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="src/favicon/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="MyWebSite" />
    <link rel="manifest" href="src/favicon/site.webmanifest" />
    <link rel="stylesheet" href="css/main.css" />
  </head>

  <body>
    <header class="site-header" role="banner">
      <nav class="site-nav" aria-label="Главная навигация">
        <a class="site-nav__brand" href="#" aria-label="На главную">
          <img class="icon icon--brand" src="src/main/logo.svg" alt="Асия" />
        </a>

        <!-- Кнопка-иконка музыки -->
        <a class="site-nav__action" href="#" aria-label="Проиграть / остановить музыку">
          <img class="icon icon--action" src="src/main/music.svg" alt="" />
        </a>
      </nav>
    </header>

    <main class="hero" role="main" aria-label="Главный экран">
      <nav class="nav-menu glass-effect" aria-label="Разделы">
        <ol class="nav">
          <li class="nav-menu__element">
            <a class="nav-link" href="#">
              <img class="nav-label el_treki" src="src/linked/Treki.svg" alt="Треки" />
            </a>
          </li>
          <li class="nav-menu__element">
            <a class="nav-link" href="#">
              <img class="nav-label el_concerts" src="src/linked/Concerts.svg" alt="Концерты" />
            </a>
          </li>
          <li class="nav-menu__element">
            <a class="nav-link" href="#">
              <img class="nav-label el_merch" src="src/linked/Merch.svg" alt="Мерч" />
            </a>
          </li>
        </ol>
      </nav>
    </main>

    <footer class="site-footer" role="contentinfo">
      <a href="#" class="site-footer__social-media" aria-label="Соцсети"><img src="src/main/link.svg" alt="" /></a>
      <a href="#" class="site-footer__contacts">контакты</a>
      <a href="#" class="site-footer__faq" aria-label="FAQ"><img src="src/main/FAQ.svg" alt="FAQ"></a>
    </footer>

    <script>
      (() => {
        const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
        const hasFinePointer = matchMedia('(hover: hover) and (pointer: fine)').matches;
        const isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
        const isiPad = /iPad/.test(navigator.userAgent) ||
                (/Macintosh/.test(navigator.userAgent) && 'ontouchend' in document);

        if (prefersReduced || !hasFinePointer || isTouch || isiPad) return;

        const nav = document.querySelector('.nav-menu');
        if (!nav) return;

        const items = nav.querySelectorAll('.nav-menu__element');

        const MAX = 5;
        const SCALE = 1.1;

        items.forEach((item) => {
          const img = item.querySelector('.nav-label');
          if (!img) return;

          let raf = null, tx = 0, ty = 0;

          function onMove(e) {
            const r = item.getBoundingClientRect();

            const nx = (e.clientX - (r.left + r.width  / 2)) / (r.width  / 2);
            const ny = (e.clientY - (r.top  + r.height / 2)) / (r.height / 2);

            tx = Math.max(-1, Math.min(1, nx)) * MAX;
            ty = Math.max(-1, Math.min(1, ny)) * MAX;

            if (!raf) raf = requestAnimationFrame(apply);
          }

          function apply() {
            raf = null;
            img.style.transform = `translate(${tx}px, ${ty}px) scale(${SCALE})`;
          }

          function reset() {
            img.style.transform = '';
          }

          item.addEventListener('mousemove', onMove);
          item.addEventListener('mouseleave', reset);

          item.addEventListener('focusin', () => { img.style.transform = `scale(${SCALE})`; });
          item.addEventListener('focusout', reset);
        });
      })();
    </script>
    <script>
      (() => {
        const anchor = document.querySelector('.site-footer__social-media');
        if (!anchor) return;ь
        anchor.setAttribute('role', 'button');
        anchor.setAttribute('aria-expanded', 'false');

        const dock = document.createElement('div');
        dock.className = 'social-dock';
        dock.id = 'social-dock';

        const items = [
          { href: '#', src: 'src/social_icons/social_telegram.svg', label: 'Telegram' },
          { href: '#', src: 'src/social_icons/social_vk.svg',       label: 'VK' },
          { href: '#', src: 'src/social_icons/social_youtube.svg',  label: 'YouTube' },
        ];

        items.forEach((it, i) => {
          const a = document.createElement('a');
          a.className = 'social-dock__btn';
          a.href = it.href;
          a.ariaLabel = it.label;
          a.style.setProperty('--delay', `${80 * (i + 1)}ms`); // каскад: 80/160/240мс

          const img = document.createElement('img');
          img.src = it.src;
          img.alt = it.label;

          a.appendChild(img);
          dock.appendChild(a);
        });

        anchor.appendChild(dock);

        function openDock() {
          anchor.classList.add('is-open');
          anchor.setAttribute('aria-expanded', 'true');
          document.addEventListener('click', onDocClick);
          document.addEventListener('keydown', onKey);
        }
        function closeDock() {
          anchor.classList.remove('is-open');
          anchor.setAttribute('aria-expanded', 'false');
          document.removeEventListener('click', onDocClick);
          document.removeEventListener('keydown', onKey);
        }
        function toggle(e){
          e.preventDefault();
          anchor.classList.contains('is-open') ? closeDock() : openDock();
        }
        function onDocClick(e){
          if (!anchor.contains(e.target)) closeDock();
        }
        function onKey(e){
          if (e.key === 'Escape') closeDock();
          if (e.key === 'Enter' || e.key === ' ') toggle(e);
        }

        anchor.addEventListener('click', toggle);
        anchor.addEventListener('keydown', onKey);
      })();
    </script>
    <script>
      (() => {
        const btn = document.querySelector('.site-nav__action');
        if (!btn) return;
        btn.setAttribute('role', 'button');
        btn.setAttribute('aria-pressed', 'false');
        let eq = btn.querySelector('.eq');
        if (!eq) {
          eq = document.createElement('span');
          eq.className = 'eq';
          for (let i = 0; i < 5; i++) {
            const bar = document.createElement('span');
            bar.className = 'eq-bar';
            eq.appendChild(bar);
          }
          btn.appendChild(eq);
        }
        const audio = new Audio('src/songs/song.mp3');
        audio.preload = 'auto';
        let timer = null;
        function tick() {
          const bars = eq.children;
          for (let i = 0; i < bars.length; i++) {
            const centerBoost = 1 - Math.abs((i - 2) / 2);
            const base = 0.25 + Math.random() * (0.55 + 0.25 * centerBoost);
            bars[i].style.setProperty('--sy', base.toFixed(2));
          }
        }
        function startEq(){ if (!timer){ tick(); timer = setInterval(tick, 140); } }
        function stopEq(){ if (timer){ clearInterval(timer); timer = null; } }

        function setPlayingUI(isOn){
          btn.classList.toggle('is-playing', isOn);
          btn.setAttribute('aria-pressed', isOn ? 'true' : 'false');
          if (isOn) startEq(); else stopEq();
        }

        async function play(){
          try{
            audio.currentTime = 0;
            await audio.play();
            setPlayingUI(true);
          }catch(err){
            console.error('Не удалось воспроизвести аудио:', err);
            setPlayingUI(false);
          }
        }

        function stop(){
          audio.pause();
          audio.currentTime = 0;
          setPlayingUI(false);
        }

        function toggle(e){
          if (e) e.preventDefault();
          if (btn.classList.contains('is-playing')) stop();
          else play();
        }

        btn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          toggle();
        });
        btn.addEventListener('keydown', (e) => {
          if (e.code === 'Space' || e.code === 'Enter') toggle(e);
        });

        audio.addEventListener('ended', () => {
          setPlayingUI(false);
          audio.currentTime = 0;
        });
      })();
    </script>

  </body>
</html>
